*deck @(#)filmas.f	5.1  11/6/94
      subroutine filmas(in,iout,ian,natoms,append,atmass,bb)
c***begin prologue     filmas.f
c***date written       820601  yymmdd
c***revision date      11/6/94
c***keywords           atomic masses
c***author             binkley, et.al., gauss82
c***source             @(#)filmas.f	5.1   11/6/94
c***purpose            assign masses to atoms.
c***description
c     call filmas(in,iout,ian,natoms,append,atmass,bb)
c
c       in     ... input unit.  if this is non-zero, this routine will
c                  prompt for the desired isotopes; otherwise the most
c                  abundant isotopes will be used (currently not implemented).
c                  currently not available.
c       iout   ... output unit, used for prompts and error messages.
c       ian    ... vector(natoms) of atomic numbers.
c       natoms ... number of atoms.
c       append ... logical variable indicating whether symbols should
c                  be appended to bb.
c       atmass ... output vector(natoms) of atomic masses in amu.
c       bb     ... if append is true, a string for each atom will be placed
c                  in bb.  the string will consist of the atomic symbol
c                  and the mass number (e.g. cl-35).
c
c
c***references         a.h.wapstra and k.bos,atomic and nuclear data tables,
c                      vol.19,185(1977).
c                      crc tables, 1981-1982.
c***routines called    fillel(util)
c***end prologue       filmas.f
      implicit none
c     --- input variables -----
      integer in,iout,natoms
      logical append
c     --- input arrays (unmodified) ---
      integer ian(natoms)
c     --- input arrays (scratch) ---
c     --- output arrays ---
      real*8 atmass(natoms)
      character*(*) bb(*)
c     --- output variables ---
c     --- scratch arrays ---
c     --- local variables ---
      integer maxel,maxiso,maxmas
      parameter (maxel=104,maxiso=4,maxmas=104)
      logical abund
      character el(maxel+1)*2
      character itoc*16
      real*8 amass(maxiso,maxel)
      real*8 dmass(maxiso*maxel)
      equivalence (amass(1,1),dmass)
      integer  mn(maxiso,maxel)
      integer dmn(maxiso*maxel)
      equivalence (mn(1,1),dmn)
      integer i,an,nmi,lenel
      real*8 rmass
      real*8 zero,half,one
c
      data zero,half,one/0.0d+00,0.5d+00,1.0d+00/
c
      save zero,half,one
      save amass,mn,dmass,dmn
      external itoc
c
c     ---
c        masses are stored in amass: amass(i,j) is the mass for the jth
c        most abundant isotope for atomic number i.  the corresponding
c        mass numbers (# of protons + # of neutrons) are stored in the
c        array mn. 
c        the masses are from a. h. wapstra and k. bos, atomic and
c        nuclear data tables, 1977, 19, 185.  
c        the isotopic abundances are from the 1981-9182 crc tables. 
c     
c        the correspondence between the data statements below
c        and atomic number, element, mass number and atomic weight
c        follow  
c
c    $   1,h ,  1,  1.007825037d0,  2,  2.014101787d0,
c               3,  3.016049286d0,  0,  0.000000000d0,
c    $   2,he,  4,  4.002603250d0,  3,  3.016029297d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $   3,li,  7,  7.016004500d0,  6,  6.015123200d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $   4,be,  9,  9.012182500d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $   5,b , 11, 11.009305300d0, 10, 10.012938000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $   6,c , 12, 12.000000000d0, 13, 13.003354839d0,
c               0, 14.003241000d0,  0,  0.000000000d0,
c    $   7,n , 14, 14.003074008d0, 15, 15.000108978d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $   8,o , 16, 15.994914640d0, 18, 17.999159390d0,
c              17, 16.999130600d0,  0,  0.000000000d0,
c    $   9,f , 19, 18.998403250d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  10,ne, 20, 19.992439100d0, 22, 21.991383700d0,
c              21, 20.993845300d0,  0,  0.000000000d0,
c    $  11,na, 23, 22.989769700d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  12,mg, 24, 23.985045000d0, 26, 25.982595400d0,
c              25, 24.985839200d0,  0,  0.000000000d0,
c    $  13,al, 27, 26.981541300d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  14,si, 28, 27.976928400d0, 29, 28.976496400d0,
c              30, 29.973771700d0,  0,  0.000000000d0,
c    $  15,p , 31, 30.973763400d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  16,s , 32, 31.972071800d0, 34, 33.967867740d0,
c              33, 32.971459100d0, 36, 35.967079000d0,
c    $  17,cl, 35, 34.968852729d0, 37, 36.965902624d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  18,ar, 40, 39.962383100d0, 36, 35.967545605d0,
c              38, 37.962732200d0,  0,  0.000000000d0,
c    $  19,k , 39, 38.963707900d0, 41, 40.961825400d0,
c              40, 39.963998800d0,  0,  0.000000000d0,
c    $  20,ca, 40, 39.962590700d0, 44, 43.955484800d0,
c              42, 41.958621800d0, 48, 47.952532000d0,
c    $  21,sc, 45, 44.955913600d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  22,ti, 48, 47.947946700d0, 46, 45.952632700d0,
c              47, 46.951764900d0, 49, 48.947870500d0,
c    $  23,v , 51, 50.943962500d0, 50, 49.947161300d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  24,cr, 52, 51.940509700d0, 53, 52.940651000d0,
c              50, 49.946046300d0, 54, 53.938882200d0,
c    $  25,mn, 55, 54.938046300d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  26,fe, 56, 55.934939300d0, 54, 53.939612100d0,
c              57, 56.935395700d0, 58, 57.933277800d0,
c    $  27,co, 59, 58.933197800d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  28,ni, 58, 57.935347100d0, 60, 59.930789000d0,
c              62, 61.928346400d0, 61, 60.931058600d0,
c    $  29,cu, 63, 62.929599200d0, 65, 64.927792400d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  30,zn, 64, 63.929145400d0, 66, 65.926035200d0,
c              68, 67.924845800d0, 67, 66.927128900d0,
c    $  31,ga, 69, 68.925580900d0, 71, 70.924700600d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  32,ge, 74, 73.921178800d0, 72, 71.922080000d0,
c              70, 69.924249800d0, 73, 72.923463900d0,
c    $  33,as, 75, 74.921595500d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  34,se, 80, 79.916520500d0, 78, 77.917304000d0,
c              82, 81.916709000d0, 76, 75.919206600d0,
c    $  35,br, 79, 78.918336100d0, 81, 80.916290000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  36,kr, 84, 83.911506400d0, 86, 85.910614000d0,
c              82, 81.913483000d0, 83, 82.914134000d0,
c    $  37,rb, 85, 84.911700000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  38,sr, 88, 87.905600000d0, 84, 83.913400000d0,
c              86, 85.909400000d0, 87, 86.908900000d0,
c    $  39,y , 89, 88.905400000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  40,zr, 90, 89.904300000d0, 91, 90.905300000d0,
c              92, 91.904600000d0, 94, 93.906100000d0,
c    $  41,nb, 93, 92.906000000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  42,mo, 98, 97.905500000d0, 92, 91.906300000d0,
c              95, 94.905840000d0, 96, 95.904600000d0,
c    $  43,tc,  0,  0.000000000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  44,ru,102,101.903700000d0, 99, 98.906100000d0,
c             100, 99.903000000d0,104,103.905500000d0,
c    $  45,rh,103,102.904800000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  46,pd,106,105.903200000d0,104,103.903600000d0,
c             105,104.904600000d0,108,107.903890000d0,
c    $  47,ag,107,106.905090000d0,109,108.904700000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  48,cd,114,113.903600000d0,110,109.903000000d0,
c             111,110.904200000d0,112,111.902800000d0,
c    $  49,in,115,114.904100000d0,113,112.904300000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  50,sn,118,117.901800000d0,116,115.902100000d0,
c             117,116.903100000d0,119,118.903400000d0,
c    $  51,sb,121,120.903800000d0,123,122.904100000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  52,te,130,129.906700000d0,125,124.904400000d0,
c             126,125.903200000d0,128,127.904700000d0,
c    $  53,i ,127,126.900400000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  54,xe,132,131.904200000d0,129,128.904800000d0,
c             131,130.905100000d0,134,133.905400000d0,
c    $  55,cs,134,133.905100000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  56,ba,138,137.905000000d0,134,133.904300000d0,
c             135,134.905600000d0,136,135.904400000d0,
c    $  57,la,139,138.906100000d0,138,137.906800000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  58,ce,140,139.905300000d0,138,137.905700000d0,
c             142,141.909000000d0,  0,  0.000000000d0,
c    $  59,pr,141,140.907400000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  60,nd,142,141.907500000d0,143,142.909600000d0,
c             144,143.909900000d0,146,145.912700000d0,
c    $  61,pm,  0,  0.000000000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  62,sm,152,151.919500000d0,147,146.914600000d0,
c             149,148.916900000d0,154,153.922000000d0,
c    $  63,eu,153,152.920900000d0,151,150.919600000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  64,gd,158,157.924100000d0,156,155.922100000d0,
c             157,156.933900000d0,160,159.927100000d0,
c    $  65,tb,159,158.925000000d0,151,150.923000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  66,dy,164,163.928800000d0,161,160.926600000d0,
c             162,161.926500000d0,163,162.928400000d0,
c    $  67,ho,165,164.930300000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  68,er,166,165.930400000d0,167,166.932000000d0,
c             168,167.932400000d0,170,169.935500000d0,
c    $  69,tm,169,168.934400000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  70,yb,174,173.939000000d0,171,170.936500000d0,
c             172,171.936600000d0,173,172.938300000d0,
c    $  71,lu,175,174.940900000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  72,hf,180,179.946800000d0,177,176.943500000d0,
c             178,177.943900000d0,179,178.946000000d0,
c    $  73,ta,181,180.948000000d0,180,179.941500000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  74,w ,184,183.951000000d0,182,181.948300000d0,
c             183,182.950300000d0,186,185.954300000d0,
c    $  75,re,187,186.956000000d0,185,184.953000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  76,os,190,189.958600000d0,188,187.956000000d0,
c             189,188.958600000d0,  0,  0.000000000d0,
c    $  77,ir,193,192.963300000d0,191,190.960900000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  78,pt,195,194.964800000d0,194,193.962800000d0,
c             196,195.965000000d0,198,197.967500000d0,
c    $  79,au,197,196.966600000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  80,hg,202,201.970600000d0,199,198.968300000d0,
c             200,199.968300000d0,201,200.970300000d0,
c    $  81,tl,205,204.974500000d0,203,202.972300000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  82,pb,208,207.976600000d0,204,203.973000000d0,
c             206,205.974500000d0,207,206.975900000d0,
c    $  83,bi,209,208.980400000d0,211,210.987300000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  84,po,209,208.982500000d0,206,205.980500000d0,
c             207,206.981600000d0,208,207.981300000d0,
c    $  85,at,211,210.987500000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  86,rn,222,222.017500000d0,211,209.989700000d0,
c             210,210.990600000d0,212,211.990700000d0,
c    $  87,fr,223,223.019800000d0,212,211.996000000d0,
c             221,221.014200000d0,  0,  0.000000000d0,
c    $  88,ra,226,226.025400000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  89,ac,227,227.027800000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  90,th,232,232.038200000d0,228,228.028700000d0,
c             229,229.031600000d0,230,230.033100000d0,
c    $  91,pa,231,231.035900000d0,234,234.043000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  92,u ,238,238.050800000d0,234,234.040900000d0,
c             235,235.043900000d0,236,236.045700000d0,
c    $  93,np,237,237.048000000d0,236,236.046600000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  94,pu,242,242.058700000d0,239,239.052200000d0,
c             240,240.054000000d0,  0,  0.000000000d0,
c    $  95,am,243,243.061400000d0,241,241.056700000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  96,cm,246,246.067400000d0,245,245.065300000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  97,bk,247,247.070200000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  98,cf,249,249.074800000d0,250,250.076600000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $  99,es,252,252.082900000d0,253,253.084700000d0,
c             254,254.088100000d0,  0,  0.000000000d0,
c    $ 100,fm,252,252.082700000d0,250,250.079500000d0,
c             254,254.087000000d0,  0,  0.000000000d0,
c    $ 101,md,255,255.090600000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $ 102,no,  0,  0.000000000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $ 103,lr,  0,  0.000000000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c    $ 104,ky,  0,  0.000000000d0,  0,  0.000000000d0,
c               0,  0.000000000d0,  0,  0.000000000d0,
c
c
      data (dmass(i),i=1,60)/
     $   1.007825037d0,  2.014101787d0,  3.016049286d0,  0.000000000d0,
     $   4.002603250d0,  3.016029297d0,  0.000000000d0,  0.000000000d0,
     $   7.016004500d0,  6.015123200d0,  0.000000000d0,  0.000000000d0,
     $   9.012182500d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  11.009305300d0, 10.012938000d0,  0.000000000d0,  0.000000000d0,
     $  12.000000000d0, 13.003354839d0, 14.003241000d0,  0.000000000d0,
     $  14.003074008d0, 15.000108978d0,  0.000000000d0,  0.000000000d0,
     $  15.994914640d0, 17.999159390d0, 16.999130600d0,  0.000000000d0,
     $  18.998403250d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  19.992439100d0, 21.991383700d0, 20.993845300d0,  0.000000000d0,
     $  22.989769700d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  23.985045000d0, 25.982595400d0, 24.985839200d0,  0.000000000d0,
     $  26.981541300d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  27.976928400d0, 28.976496400d0, 29.973771700d0,  0.000000000d0,
     $  30.973763400d0,  0.000000000d0,  0.000000000d0,  0.000000000d0/
      data (dmass(i),i=61,120)/
     $  31.972071800d0, 33.967867740d0, 32.971459100d0, 35.967079000d0,
     $  34.968852729d0, 36.965902624d0,  0.000000000d0,  0.000000000d0,
     $  39.962383100d0, 35.967545605d0, 37.962732200d0,  0.000000000d0,
     $  38.963707900d0, 40.961825400d0, 39.963998800d0,  0.000000000d0,
     $  39.962590700d0, 43.955484800d0, 41.958621800d0, 47.952532000d0,
     $  44.955913600d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  47.947946700d0, 45.952632700d0, 46.951764900d0, 48.947870500d0,
     $  50.943962500d0, 49.947161300d0,  0.000000000d0,  0.000000000d0,
     $  51.940509700d0, 52.940651000d0, 49.946046300d0, 53.938882200d0,
     $  54.938046300d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  55.934939300d0, 53.939612100d0, 56.935395700d0, 57.933277800d0,
     $  58.933197800d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  57.935347100d0, 59.930789000d0, 61.928346400d0, 60.931058600d0,
     $  62.929599200d0, 64.927792400d0,  0.000000000d0,  0.000000000d0,
     $  63.929145400d0, 65.926035200d0, 67.924845800d0, 66.927128900d0/
      data (dmass(i),i=121,180)/
     $  68.925580900d0, 70.924700600d0,  0.000000000d0,  0.000000000d0,
     $  73.921178800d0, 71.922080000d0, 69.924249800d0, 72.923463900d0,
     $  74.921595500d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  79.916520500d0, 77.917304000d0, 81.916709000d0, 75.919206600d0,
     $  78.918336100d0, 80.916290000d0,  0.000000000d0,  0.000000000d0,
     $  83.911506400d0, 85.910614000d0, 81.913483000d0, 82.914134000d0,
     $  84.911700000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  87.905600000d0, 83.913400000d0, 85.909400000d0, 86.908900000d0,
     $  88.905400000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  89.904300000d0, 90.905300000d0, 91.904600000d0, 93.906100000d0,
     $  92.906000000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $  97.905500000d0, 91.906300000d0, 94.905840000d0, 95.904600000d0,
     $   0.000000000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 101.903700000d0, 98.906100000d0, 99.903000000d0,103.905500000d0,
     $ 102.904800000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0/
      data (dmass(i),i=181,240)/
     $ 105.903200000d0,103.903600000d0,104.904600000d0,107.903890000d0,
     $ 106.905090000d0,108.904700000d0,  0.000000000d0,  0.000000000d0,
     $ 113.903600000d0,109.903000000d0,110.904200000d0,111.902800000d0,
     $ 114.904100000d0,112.904300000d0,  0.000000000d0,  0.000000000d0,
     $ 117.901800000d0,115.902100000d0,116.903100000d0,118.903400000d0,
     $ 120.903800000d0,122.904100000d0,  0.000000000d0,  0.000000000d0,
     $ 129.906700000d0,124.904400000d0,125.903200000d0,127.904700000d0,
     $ 126.900400000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 131.904200000d0,128.904800000d0,130.905100000d0,133.905400000d0,
     $ 133.905100000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 137.905000000d0,133.904300000d0,134.905600000d0,135.904400000d0,
     $ 138.906100000d0,137.906800000d0,  0.000000000d0,  0.000000000d0,
     $ 139.905300000d0,137.905700000d0,141.909000000d0,  0.000000000d0,
     $ 140.907400000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 141.907500000d0,142.909600000d0,143.909900000d0,145.912700000d0/
      data (dmass(i),i=241,300)/
     $   0.000000000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 151.919500000d0,146.914600000d0,148.916900000d0,153.922000000d0,
     $ 152.920900000d0,150.919600000d0,  0.000000000d0,  0.000000000d0,
     $ 157.924100000d0,155.922100000d0,156.933900000d0,159.927100000d0,
     $ 158.925000000d0,150.923000000d0,  0.000000000d0,  0.000000000d0,
     $ 163.928800000d0,160.926600000d0,161.926500000d0,162.928400000d0,
     $ 164.930300000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 165.930400000d0,166.932000000d0,167.932400000d0,169.935500000d0,
     $ 168.934400000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 173.939000000d0,170.936500000d0,171.936600000d0,172.938300000d0,
     $ 174.940900000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 179.946800000d0,176.943500000d0,177.943900000d0,178.946000000d0,
     $ 180.948000000d0,179.941500000d0,  0.000000000d0,  0.000000000d0,
     $ 183.951000000d0,181.948300000d0,182.950300000d0,185.954300000d0,
     $ 186.956000000d0,184.953000000d0,  0.000000000d0,  0.000000000d0/
      data (dmass(i),i=301,360)/
     $ 189.958600000d0,187.956000000d0,188.958600000d0,  0.000000000d0,
     $ 192.963300000d0,190.960900000d0,  0.000000000d0,  0.000000000d0,
     $ 194.964800000d0,193.962800000d0,195.965000000d0,197.967500000d0,
     $ 196.966600000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 201.970600000d0,198.968300000d0,199.968300000d0,200.970300000d0,
     $ 204.974500000d0,202.972300000d0,  0.000000000d0,  0.000000000d0,
     $ 207.976600000d0,203.973000000d0,205.974500000d0,206.975900000d0,
     $ 208.980400000d0,210.987300000d0,  0.000000000d0,  0.000000000d0,
     $ 208.982500000d0,205.980500000d0,206.981600000d0,207.981300000d0,
     $ 210.987500000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 222.017500000d0,209.989700000d0,210.990600000d0,211.990700000d0,
     $ 223.019800000d0,211.996000000d0,221.014200000d0,  0.000000000d0,
     $ 226.025400000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 227.027800000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 232.038200000d0,228.028700000d0,229.031600000d0,230.033100000d0/
      data (dmass(i),i=361,416)/
     $ 231.035900000d0,234.043000000d0,  0.000000000d0,  0.000000000d0,
     $ 238.050800000d0,234.040900000d0,235.043900000d0,236.045700000d0,
     $ 237.048000000d0,236.046600000d0,  0.000000000d0,  0.000000000d0,
     $ 242.058700000d0,239.052200000d0,240.054000000d0,  0.000000000d0,
     $ 243.061400000d0,241.056700000d0,  0.000000000d0,  0.000000000d0,
     $ 246.067400000d0,245.065300000d0,  0.000000000d0,  0.000000000d0,
     $ 247.070200000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $ 249.074800000d0,250.076600000d0,  0.000000000d0,  0.000000000d0,
     $ 252.082900000d0,253.084700000d0,254.088100000d0,  0.000000000d0,
     $ 252.082700000d0,250.079500000d0,254.087000000d0,  0.000000000d0,
     $ 255.090600000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $   0.000000000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $   0.000000000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0,
     $   0.000000000d0,  0.000000000d0,  0.000000000d0,  0.000000000d0/
c
c
      data (dmn(i),i=1,60)/
     $  1,  2,  3,  0,     4,  3,  0,  0,     7,  6,  0,  0,
     $  9,  0,  0,  0,    11, 10,  0,  0,    12, 13,  0,  0,
     $ 14, 15,  0,  0,    16, 18, 17,  0,    19,  0,  0,  0,
     $ 20, 22, 21,  0,    23,  0,  0,  0,    24, 26, 25,  0,
     $ 27,  0,  0,  0,    28, 29, 30,  0,    31,  0,  0,  0/
      data (dmn(i),i=61,120)/
     $ 32, 34, 33, 36,    35, 37,  0,  0,    40, 36, 38,  0,
     $ 39, 41, 40,  0,    40, 44, 42, 48,    45,  0,  0,  0,
     $ 48, 46, 47, 49,    51, 50,  0,  0,    52, 53, 50, 54,
     $ 55,  0,  0,  0,    56, 54, 57, 58,    59,  0,  0,  0,
     $ 58, 60, 62, 61,    63, 65,  0,  0,    64, 66, 68, 67/
      data (dmn(i),i=121,180)/
     $ 69, 71,  0,  0,    74, 72, 70, 73,    75,  0,  0,  0,
     $ 80, 78, 82, 76,    79, 81,  0,  0,    84, 86, 82, 83,
     $ 85,  0,  0,  0,    88, 84, 86, 87,    89,  0,  0,  0,
     $ 90, 91, 92, 94,    93,  0,  0,  0,    98, 92, 95, 96,
     $  0,  0,  0,  0,   102, 99,100,104,   103,  0,  0,  0/
      data (dmn(i),i=181,240)/
     $106,104,105,108,   107,109,  0,  0,   114,110,111,112,
     $115,113,  0,  0,   118,116,117,119,   121,123,  0,  0,
     $130,125,126,128,   127,  0,  0,  0,   132,129,131,134,
     $134,  0,  0,  0,   138,134,135,136,   139,138,  0,  0,
     $140,138,142,  0,   141,  0,  0,  0,   142,143,144,146/
      data (dmn(i),i=241,300)/
     $  0,  0,  0,  0,   152,147,149,154,   153,151,  0,  0,
     $158,156,157,160,   159,151,  0,  0,   164,161,162,163,
     $165,  0,  0,  0,   166,167,168,170,   169,  0,  0,  0,
     $174,171,172,173,   175,  0,  0,  0,   180,177,178,179,
     $181,180,  0,  0,   184,182,183,186,   187,185,  0,  0/
      data (dmn(i),i=301,360)/
     $190,188,189,  0,   193,191,  0,  0,   195,194,196,198,
     $197,  0,  0,  0,   202,199,200,201,   205,203,  0,  0,
     $208,204,206,207,   209,211,  0,  0,   209,206,207,208,
     $211,  0,  0,  0,   222,211,210,212,   223,212,221,  0,
     $226,  0,  0,  0,   227,  0,  0,  0,   232,228,229,230/
      data (dmn(i),i=361,416)/
     $231,234,  0,  0,   238,234,235,236,   237,236,  0,  0,
     $242,239,240,  0,   243,241,  0,  0,   246,245,  0,  0,
     $247,  0,  0,  0,   249,250,  0,  0,   252,253,254,  0,
     $252,250,254,  0,   255,  0,  0,  0,     0,  0,  0,  0,
     $  0,  0,  0,  0,     0,  0,  0,  0/
c
 1000 format(' for each atom, give the integer mass number.',/,
     $       ' in each case, the default is the principal isotope.')
 1010 format(6f10.5)
 1020 format(' atom',i3,' has atomic number',i3,
     $       ' -- mass set to 1.')
 1030 format(' only principal abundance masses currently available.')
c
c
      call fillel(0,maxel,el)
      abund = .true.
      if(in.ne.0) write(iout,1030)
      do 50 i = 1, natoms
         an = ian(i)
         rmass=one
         if(an.ge.1.and.an.le.maxmas) then
c           --- normal case, make sure that a mass number is given
            nmi=mn(1,an)
            if(nmi.eq.0) then
               write(iout,1020) i,an
               rmass=one
            else
               rmass=amass(1,an)
            endif
         else if(an.eq.0) then
c           --- ghost center (may have a basis set)
            nmi=0
            rmass=zero
         else if(an.lt.0.or.an.gt.maxmas) then
c           --- either a dummy or an element not in the list.
            write(iout,1020) i,an
            nmi=1
            rmass=one
         endif
         if (append) then
            lenel=index(el(an+1),' ')-1
            if(lenel.le.0) lenel=2
            bb(i)=el(an+1)(1:lenel)//'-'//itoc(nmi)
         endif
   50 atmass(i) = rmass
c
c
      return
      end
