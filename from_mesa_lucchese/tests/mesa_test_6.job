#!/bin/bash

# Needed environment variables
# TMPDIR - directory for work directory
# MESA - main mesa directory
# ver - which compiler version (beginning with a period or blank)

date

echo mesa test 6 - avtzp NO2 SD CI with 165 funcs
echo using version $ver

PATH=$PATH:$MESA/bin$ver
rundir=run_mesa_test_6$ver

cd $TMPDIR
rm -r $rundir
mkdir $rundir
cd $rundir
cp $MESA/mesa.dat .
mkdir tmp

siz=4000000

cat <<EOF | sed -e "s/#.*//" > mesacmn.inp 

\$geom
N1(basis=ePolyScat1)    0.00000000E+00   0.00000000E+00   0.00000000E+00
O1(basis=ePolyScat2)    0.00000000E+00   0.20767736E+01   0.88472676E+00
O2(basis=ePolyScat3)    0.00000000E+00  -0.20767736E+01   0.88472676E+00
\$end

\$ePolyScat1 N
type=s
   0.11420000E+05   0.52299966E-03
   0.17120000E+04   0.40449973E-02
   0.38930000E+03   0.20774986E-01
   0.11000000E+03   0.80726947E-01
   0.35570000E+02   0.23307385E+00
   0.12540000E+02   0.43350071E+00
   0.46440000E+01   0.34747177E+00
   0.12930000E+01   0.41261973E-01
   0.51180000E+00  -0.85079944E-02
   0.17870000E+00   0.23839984E-02
type=s
   0.11420000E+05  -0.11499995E-03
   0.17120000E+04  -0.89499965E-03
   0.38930000E+03  -0.46239982E-02
   0.11000000E+03  -0.18527993E-01
   0.35570000E+02  -0.57338977E-01
   0.12540000E+02  -0.13207595E+00
   0.46440000E+01  -0.17250993E+00
   0.12930000E+01   0.15181394E+00
   0.51180000E+00   0.59994376E+00
   0.17870000E+00   0.38746185E+00
type=s
   0.11420000E+05   0.00000000E+00
   0.17120000E+04   0.00000000E+00
   0.38930000E+03   0.00000000E+00
   0.11000000E+03   0.00000000E+00
   0.35570000E+02   0.00000000E+00
   0.12540000E+02   0.00000000E+00
   0.46440000E+01   0.00000000E+00
   0.12930000E+01   0.10000000E+01
   0.51180000E+00   0.00000000E+00
   0.17870000E+00   0.00000000E+00
type=s
   0.11420000E+05   0.00000000E+00
   0.17120000E+04   0.00000000E+00
   0.38930000E+03   0.00000000E+00
   0.11000000E+03   0.00000000E+00
   0.35570000E+02   0.00000000E+00
   0.12540000E+02   0.00000000E+00
   0.46440000E+01   0.00000000E+00
   0.12930000E+01   0.00000000E+00
   0.51180000E+00   0.00000000E+00
   0.17870000E+00   0.10000000E+01
type=s
   0.57600000E-01   0.10000000E+01
type=p
   0.26630000E+02   0.14670003E-01
   0.59480000E+01   0.91764022E-01
   0.17420000E+01   0.29868307E+00
   0.55500000E+00   0.49848712E+00
   0.17250000E+00   0.33702308E+00
type=p
   0.26630000E+02   0.00000000E+00
   0.59480000E+01   0.00000000E+00
   0.17420000E+01   0.00000000E+00
   0.55500000E+00   0.10000000E+01
   0.17250000E+00   0.00000000E+00
type=p
   0.26630000E+02   0.00000000E+00
   0.59480000E+01   0.00000000E+00
   0.17420000E+01   0.00000000E+00
   0.55500000E+00   0.00000000E+00
   0.17250000E+00   0.10000000E+01
type=p
   0.49100000E-01   0.10000000E+01
type=d
   0.16540000E+01   0.10000000E+01
type=d
   0.46900000E+00   0.10000000E+01
type=d
   0.15100000E+00   0.10000000E+01
type=f
   0.10930000E+01   0.10000000E+01
type=f
   0.36400000E+00   0.10000000E+01
\$end

\$ePolyScat2 O
type=s
   0.15330000E+05   0.50799967E-03
   0.22990000E+04   0.39289974E-02
   0.52240000E+03   0.20242987E-01
   0.14730000E+03   0.79180948E-01
   0.47550000E+02   0.23068685E+00
   0.16760000E+02   0.43311772E+00
   0.62070000E+01   0.35025977E+00
   0.17520000E+01   0.42727972E-01
   0.68820000E+00  -0.81539947E-02
   0.23840000E+00   0.23809984E-02
type=s
   0.15330000E+05  -0.11500006E-03
   0.22990000E+04  -0.89500047E-03
   0.52240000E+03  -0.46360024E-02
   0.14730000E+03  -0.18724010E-01
   0.47550000E+02  -0.58463031E-01
   0.16760000E+02  -0.13646307E+00
   0.62070000E+01  -0.17574009E+00
   0.17520000E+01   0.16093408E+00
   0.68820000E+00   0.60341832E+00
   0.23840000E+00   0.37876520E+00
type=s
   0.15330000E+05   0.00000000E+00
   0.22990000E+04   0.00000000E+00
   0.52240000E+03   0.00000000E+00
   0.14730000E+03   0.00000000E+00
   0.47550000E+02   0.00000000E+00
   0.16760000E+02   0.00000000E+00
   0.62070000E+01   0.00000000E+00
   0.17520000E+01   0.10000000E+01
   0.68820000E+00   0.00000000E+00
   0.23840000E+00   0.00000000E+00
type=s
   0.15330000E+05   0.00000000E+00
   0.22990000E+04   0.00000000E+00
   0.52240000E+03   0.00000000E+00
   0.14730000E+03   0.00000000E+00
   0.47550000E+02   0.00000000E+00
   0.16760000E+02   0.00000000E+00
   0.62070000E+01   0.00000000E+00
   0.17520000E+01   0.00000000E+00
   0.68820000E+00   0.00000000E+00
   0.23840000E+00   0.10000000E+01
type=s
   0.73760000E-01   0.10000000E+01
type=p
   0.34460000E+02   0.15927991E-01
   0.77490000E+01   0.99739942E-01
   0.22800000E+01   0.31049182E+00
   0.71560000E+00   0.49102571E+00
   0.21400000E+00   0.33633680E+00
type=p
   0.34460000E+02   0.00000000E+00
   0.77490000E+01   0.00000000E+00
   0.22800000E+01   0.00000000E+00
   0.71560000E+00   0.10000000E+01
   0.21400000E+00   0.00000000E+00
type=p
   0.34460000E+02   0.00000000E+00
   0.77490000E+01   0.00000000E+00
   0.22800000E+01   0.00000000E+00
   0.71560000E+00   0.00000000E+00
   0.21400000E+00   0.10000000E+01
type=p
   0.59740000E-01   0.10000000E+01
type=d
   0.23140000E+01   0.10000000E+01
type=d
   0.64500000E+00   0.10000000E+01
type=d
   0.21400000E+00   0.10000000E+01
type=f
   0.14280000E+01   0.10000000E+01
type=f
   0.50000000E+00   0.10000000E+01
\$end

\$ePolyScat3 O
type=s
   0.15330000E+05   0.50799967E-03
   0.22990000E+04   0.39289974E-02
   0.52240000E+03   0.20242987E-01
   0.14730000E+03   0.79180948E-01
   0.47550000E+02   0.23068685E+00
   0.16760000E+02   0.43311772E+00
   0.62070000E+01   0.35025977E+00
   0.17520000E+01   0.42727972E-01
   0.68820000E+00  -0.81539947E-02
   0.23840000E+00   0.23809984E-02
type=s
   0.15330000E+05  -0.11500006E-03
   0.22990000E+04  -0.89500047E-03
   0.52240000E+03  -0.46360024E-02
   0.14730000E+03  -0.18724010E-01
   0.47550000E+02  -0.58463031E-01
   0.16760000E+02  -0.13646307E+00
   0.62070000E+01  -0.17574009E+00
   0.17520000E+01   0.16093408E+00
   0.68820000E+00   0.60341832E+00
   0.23840000E+00   0.37876520E+00
type=s
   0.15330000E+05   0.00000000E+00
   0.22990000E+04   0.00000000E+00
   0.52240000E+03   0.00000000E+00
   0.14730000E+03   0.00000000E+00
   0.47550000E+02   0.00000000E+00
   0.16760000E+02   0.00000000E+00
   0.62070000E+01   0.00000000E+00
   0.17520000E+01   0.10000000E+01
   0.68820000E+00   0.00000000E+00
   0.23840000E+00   0.00000000E+00
type=s
   0.15330000E+05   0.00000000E+00
   0.22990000E+04   0.00000000E+00
   0.52240000E+03   0.00000000E+00
   0.14730000E+03   0.00000000E+00
   0.47550000E+02   0.00000000E+00
   0.16760000E+02   0.00000000E+00
   0.62070000E+01   0.00000000E+00
   0.17520000E+01   0.00000000E+00
   0.68820000E+00   0.00000000E+00
   0.23840000E+00   0.10000000E+01
type=s
   0.73760000E-01   0.10000000E+01
type=p
   0.34460000E+02   0.15927991E-01
   0.77490000E+01   0.99739942E-01
   0.22800000E+01   0.31049182E+00
   0.71560000E+00   0.49102571E+00
   0.21400000E+00   0.33633680E+00
type=p
   0.34460000E+02   0.00000000E+00
   0.77490000E+01   0.00000000E+00
   0.22800000E+01   0.00000000E+00
   0.71560000E+00   0.10000000E+01
   0.21400000E+00   0.00000000E+00
type=p
   0.34460000E+02   0.00000000E+00
   0.77490000E+01   0.00000000E+00
   0.22800000E+01   0.00000000E+00
   0.71560000E+00   0.00000000E+00
   0.21400000E+00   0.10000000E+01
type=p
   0.59740000E-01   0.10000000E+01
type=d
   0.23140000E+01   0.10000000E+01
type=d
   0.64500000E+00   0.10000000E+01
type=d
   0.21400000E+00   0.10000000E+01
type=f
   0.14280000E+01   0.10000000E+01
type=f
   0.50000000E+00   0.10000000E+01
\$end
EOF
cat <<EOF | sed -e "s/#.*//" > mesa.inp 
\$title
tzp NO2 scf
\$end

\$route
sym=norotate
maxsiz=900000
2s+1=2
print=(basis)
hf scf=(pulay)
guess=(core)
sym=off
geom=(inau,coord)
\$end
EOF
cat <mesacmn.inp >>mesa.inp
optmesa siz=$siz
mv mesa.out out.scf
cat out.scf
mv mesa.inp inp.scf

cat <<EOF | sed -e "s/#.*//" > mesa.inp 
\$title
   avtzp NO2 SD CI 
\$end

\$route
maxsiz=1300000
2s+1=2
ci
guess=(chk) 
sym=off 
geom=(inau,coord)
drt=(vexcite=2,refexcite=99)
\$end

\$drt
3cor1 8doc1 1alp1 153uoc1
\$end

EOF
cat <mesacmn.inp >> mesa.inp
optmesa siz=$siz
mv mesa.out out.ci
mv mesa.inp inp.ci
cat out.ci

date
