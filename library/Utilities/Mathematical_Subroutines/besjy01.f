*deck besjy01
        subroutine besjy01(x,bj0,dj0,bj1,dj1,by0,dy0,by1,dy1)
c
c       =======================================================
c       purpose: compute bessel functions j0(x), j1(x), y0(x),
c                y1(x), and their derivatives
c       input :  x   --- argument of jn(x) & yn(x) ( x ò 0 )
c       output:  bj0 --- j0(x)
c                dj0 --- j0'(x)
c                bj1 --- j1(x)
c                dj1 --- j1'(x)
c                by0 --- y0(x)
c                dy0 --- y0'(x)
c                by1 --- y1(x)
c                dy1 --- y1'(x)
c       =======================================================
c
        implicit integer(a-z)
        real*8 x, bj0, dj0, bj1, dj1, by0, dy0, by1, dy1
        real*8 pi, t, t2, a0, p0, q0, ta0, p1, q1, ta1
        data pi / 3.141592653589793238462643d+00 /
        if (x.eq.0.0d0) then
           bj0=1.0d0
           bj1=0.0d0
           dj0=0.0d0
           dj1=0.5d0
           by0=-1.0d+300
           by1=-1.0d+300
           dy0=1.0d+300
           dy1=1.0d+300
           return
        else if (x.le.4.0d0) then
           t=x/4.0d0
           t2=t*t
           bj0=((((((-.5014415d-3*t2+.76771853d-2)*t2
     &         -.0709253492d0)*t2+.4443584263d0)*t2
     &         -1.7777560599d0)*t2+3.9999973021d0)
     &         *t2-3.9999998721d0)*t2+1.0d0
           bj1=t*(((((((-.1289769d-3*t2+.22069155d-2)
     &         *t2-.0236616773d0)*t2+.1777582922d0)*t2
     &         -.8888839649d0)*t2+2.6666660544d0)*t2
     &         -3.9999999710d0)*t2+1.9999999998d0)
           by0=(((((((-.567433d-4*t2+.859977d-3)*t2
     &         -.94855882d-2)*t2+.0772975809d0)*t2
     &         -.4261737419d0)*t2+1.4216421221d0)*t2
     &         -2.3498519931d0)*t2+1.0766115157)*t2
     &         +.3674669052d0
           by0=2.0d0/pi*dlog(x/2.0d0)*bj0+by0
           by1=((((((((.6535773d-3*t2-.0108175626d0)*t2
     &         +.107657606d0)*t2-.7268945577d0)*t2
     &         +3.1261399273d0)*t2-7.3980241381d0)*t2
     &         +6.8529236342d0)*t2+.3932562018d0)*t2
     &         -.6366197726d0)/x
           by1=2.0d0/pi*log(x/2.0d0)*bj1+by1
        else
           t=4.0d0/x
           t2=t*t
           a0=sqrt(2.0d0/(pi*x))
           p0=((((-.9285d-5*t2+.43506d-4)*t2-.122226d-3)*t2
     &        +.434725d-3)*t2-.4394275d-2)*t2+.999999997d0
           q0=t*(((((.8099d-5*t2-.35614d-4)*t2+.85844d-4)*t2
     &        -.218024d-3)*t2+.1144106d-2)*t2-.031249995d0)
           ta0=x-.25d0*pi
           bj0=a0*(p0*cos(ta0)-q0*sin(ta0))
           by0=a0*(p0*sin(ta0)+q0*cos(ta0))
           p1=((((.10632d-4*t2-.50363d-4)*t2+.145575d-3)*t2
     &        -.559487d-3)*t2+.7323931d-2)*t2+1.000000004d0
           q1=t*(((((-.9173d-5*t2+.40658d-4)*t2-.99941d-4)*t2
     &        +.266891d-3)*t2-.1601836d-2)*t2+.093749994d0)
           ta1=x-.75d0*pi
           bj1=a0*(p1*cos(ta1)-q1*sin(ta1))
           by1=a0*(p1*sin(ta1)+q1*cos(ta1))
        endif
        dj0=-bj1
        dj1=bj0-bj1/x
        dy0=-by1
        dy1=by0-by1/x
        return
        end
