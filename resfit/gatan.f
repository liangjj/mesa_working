*deck gatan
      function gatan(x)
      real *8 x, gatan
      gatan=x/(1.+abs(x))
      return
      end
